2022-08-09 04:56:16,478 - root - INFO - Min time is 1464710400, Train time is 10, Val time is 13, Test time is 16, Time unit is 3600
2022-08-09 04:57:14,643 - root - INFO - Total Trans num is 1572287, Train cas num is 27353, Val cas num is 5861, Test cas num is 5862
2022-08-09 04:57:14,760 - root - INFO - Time cost for loading data is 74.87966442108154s
2022-08-09 04:57:14,763 - root - INFO - {'dataset': 'weibo', 'bs': 50, 'prefix': 'merge_static_dynamic_weibo_concat', 'epoch': 150, 'lr': 0.0001, 'run': 1, 'gpu': 1, 'node_dim': 64, 'time_dim': 16, 'message_dim': 64, 'memory_dim': 64, 'emb_dim': 64, 'patience': 15, 'predictor': 'merge', 'embedding_module': 'seq', 'message_function': 'mlp', 'message_generator': 'concat', 'single': False, 'warmup': False, 'datasplit': 'split', 'emb_agg': 'last', 'not_distinguish_source': False, 'use_bank': False, 'use_static': True, 'dropout': 0.6, 'static_weight': 0.1, 'model_path': 'saved_models/merge_static_dynamic_weibo_concat', 'result_path': 'results/merge_static_dynamic_weibo_concat', 'log_path': 'log/merge_static_dynamic_weibo_concat.log', 'observe_time': 1, 'predict_time': 500, 'time_unit': 3600, 'train_time': 10, 'val_time': 13, 'test_time': 16, 'min_cas_size': 11, 'max_cas_size': 100, 'max_time': {'user': 1, 'cas': 1}, 'node_num': {'user': 918852, 'cas': 39076}, 'max_global_time': 18.99888888888889}
2022-08-09 04:57:14,763 - root - INFO - begin runs:0
2022-08-09 04:57:21,331 - root - INFO - Start training citation
2022-08-09 04:57:21,336 - root - INFO - Epoch 0:
2022-08-09 06:46:31,067 - root - INFO - Epoch0: time_cost:4251.358782529831 train_loss:3.6374442078242595
2022-08-09 06:46:31,067 - root - INFO - train: loss:3.0592	rmse:3.0008	mae:1.2460	pmae:0.2973	pcc:0.7207
2022-08-09 06:46:31,067 - root - INFO - val: loss:3.0303	rmse:3.0180	mae:1.2480	pmae:0.2938	pcc:0.7233
2022-08-09 06:46:31,067 - root - INFO - test: loss:2.9839	rmse:2.9431	mae:1.2377	pmae:0.2977	pcc:0.7284
2022-08-09 06:46:37,180 - root - INFO - Epoch 1:
2022-08-09 08:19:10,395 - root - INFO - Epoch1: time_cost:3301.729307413101 train_loss:2.850317253844209
2022-08-09 08:19:10,396 - root - INFO - train: loss:2.8545	rmse:2.8072	mae:1.1992	pmae:0.2790	pcc:0.7424
2022-08-09 08:19:10,396 - root - INFO - val: loss:2.8733	rmse:2.8634	mae:1.2079	pmae:0.2785	pcc:0.7404
2022-08-09 08:19:10,396 - root - INFO - test: loss:2.8345	rmse:2.7954	mae:1.2031	pmae:0.2833	pcc:0.7444
2022-08-09 08:19:17,216 - root - INFO - Epoch 2:
2022-08-09 09:52:08,162 - root - INFO - Epoch2: time_cost:3280.5926308631897 train_loss:2.7330249853897044
2022-08-09 09:52:08,163 - root - INFO - train: loss:2.6848	rmse:2.6490	mae:1.1581	pmae:0.2727	pcc:0.7591
2022-08-09 09:52:08,163 - root - INFO - val: loss:2.7546	rmse:2.7478	mae:1.1772	pmae:0.2759	pcc:0.7523
2022-08-09 09:52:08,163 - root - INFO - test: loss:2.7238	rmse:2.6863	mae:1.1765	pmae:0.2813	pcc:0.7566
2022-08-09 09:52:17,306 - root - INFO - Epoch 3:
2022-08-09 11:26:03,948 - root - INFO - Epoch3: time_cost:3288.7518424987793 train_loss:2.652178815266151
2022-08-09 11:26:03,948 - root - INFO - train: loss:2.5713	rmse:2.5447	mae:1.1243	pmae:0.2652	pcc:0.7702
2022-08-09 11:26:03,948 - root - INFO - val: loss:2.7075	rmse:2.7001	mae:1.1553	pmae:0.2717	pcc:0.7573
2022-08-09 11:26:03,948 - root - INFO - test: loss:2.6730	rmse:2.6309	mae:1.1557	pmae:0.2771	pcc:0.7625
2022-08-09 11:26:10,821 - root - INFO - Epoch 4:
2022-08-09 12:59:45,820 - root - INFO - Epoch4: time_cost:3230.4805603027344 train_loss:2.564339192595708
2022-08-09 12:59:45,820 - root - INFO - train: loss:2.4476	rmse:2.4292	mae:1.0937	pmae:0.2572	pcc:0.7827
2022-08-09 12:59:45,820 - root - INFO - val: loss:2.6858	rmse:2.6806	mae:1.1483	pmae:0.2697	pcc:0.7597
2022-08-09 12:59:45,820 - root - INFO - test: loss:2.6242	rmse:2.5841	mae:1.1483	pmae:0.2750	pcc:0.7682
2022-08-09 12:59:55,465 - root - INFO - Epoch 5:
2022-08-09 14:33:21,365 - root - INFO - Epoch5: time_cost:3297.5455503463745 train_loss:2.4713571877896254
2022-08-09 14:33:21,366 - root - INFO - train: loss:2.3004	rmse:2.2911	mae:1.0507	pmae:0.2450	pcc:0.7966
2022-08-09 14:33:21,366 - root - INFO - val: loss:2.6765	rmse:2.6692	mae:1.1441	pmae:0.2674	pcc:0.7611
2022-08-09 14:33:21,366 - root - INFO - test: loss:2.6044	rmse:2.5645	mae:1.1408	pmae:0.2713	pcc:0.7702
2022-08-09 14:33:28,919 - root - INFO - Epoch 6:
2022-08-09 16:05:31,975 - root - INFO - Epoch6: time_cost:3255.6977150440216 train_loss:2.3538912070433216
2022-08-09 16:05:31,977 - root - INFO - train: loss:2.1183	rmse:2.1161	mae:0.9902	pmae:0.2312	pcc:0.8143
2022-08-09 16:05:31,977 - root - INFO - val: loss:2.6617	rmse:2.6536	mae:1.1393	pmae:0.2669	pcc:0.7623
2022-08-09 16:05:31,977 - root - INFO - test: loss:2.6372	rmse:2.5929	mae:1.1414	pmae:0.2723	pcc:0.7667
2022-08-09 16:05:42,501 - root - INFO - Epoch 7:
2022-08-09 17:38:42,518 - root - INFO - Epoch7: time_cost:3240.468544960022 train_loss:2.2360626127001373
2022-08-09 17:38:42,518 - root - INFO - train: loss:1.9764	rmse:1.9756	mae:0.9437	pmae:0.2187	pcc:0.8285
2022-08-09 17:38:42,518 - root - INFO - val: loss:2.7047	rmse:2.6984	mae:1.1495	pmae:0.2679	pcc:0.7580
2022-08-09 17:38:42,518 - root - INFO - test: loss:2.6720	rmse:2.6269	mae:1.1536	pmae:0.2730	pcc:0.7637
2022-08-09 17:38:46,022 - root - INFO - Epoch 8:
2022-08-09 19:12:37,012 - root - INFO - Epoch8: time_cost:3301.8293652534485 train_loss:2.1081336518090708
2022-08-09 19:12:37,012 - root - INFO - train: loss:1.7815	rmse:1.7850	mae:0.8901	pmae:0.2091	pcc:0.8482
2022-08-09 19:12:37,012 - root - INFO - val: loss:2.6970	rmse:2.6889	mae:1.1525	pmae:0.2724	pcc:0.7607
2022-08-09 19:12:37,012 - root - INFO - test: loss:2.6675	rmse:2.6257	mae:1.1614	pmae:0.2795	pcc:0.7663
2022-08-09 19:12:41,222 - root - INFO - Epoch 9:
2022-08-09 20:45:33,545 - root - INFO - Epoch9: time_cost:3273.2332906723022 train_loss:1.9669300386151276
2022-08-09 20:45:33,546 - root - INFO - train: loss:1.6322	rmse:1.6359	mae:0.8280	pmae:0.1864	pcc:0.8607
2022-08-09 20:45:33,546 - root - INFO - val: loss:2.7118	rmse:2.7069	mae:1.1513	pmae:0.2639	pcc:0.7569
2022-08-09 20:45:33,546 - root - INFO - test: loss:2.6426	rmse:2.6019	mae:1.1473	pmae:0.2669	pcc:0.7652
2022-08-09 20:45:37,634 - root - INFO - Epoch 10:
2022-08-09 22:16:05,507 - root - INFO - Epoch10: time_cost:3247.518830060959 train_loss:1.8074849468920753
2022-08-09 22:16:05,507 - root - INFO - train: loss:1.4718	rmse:1.4744	mae:0.7761	pmae:0.1720	pcc:0.8753
2022-08-09 22:16:05,507 - root - INFO - val: loss:2.7637	rmse:2.7547	mae:1.1618	pmae:0.2634	pcc:0.7525
2022-08-09 22:16:05,507 - root - INFO - test: loss:2.7200	rmse:2.6807	mae:1.1635	pmae:0.2680	pcc:0.7575
2022-08-09 22:16:08,833 - root - INFO - Epoch 11:
2022-08-09 23:53:05,600 - root - INFO - Epoch11: time_cost:3289.8682453632355 train_loss:1.6626539661332342
2022-08-09 23:53:05,601 - root - INFO - train: loss:1.1912	rmse:1.2119	mae:0.7196	pmae:0.1657	pcc:0.8999
2022-08-09 23:53:05,601 - root - INFO - val: loss:2.6984	rmse:2.6977	mae:1.1659	pmae:0.2749	pcc:0.7655
2022-08-09 23:53:05,601 - root - INFO - test: loss:2.6957	rmse:2.6529	mae:1.1721	pmae:0.2814	pcc:0.7692
2022-08-09 23:53:09,274 - root - INFO - Epoch 12:
2022-08-10 01:47:33,691 - root - INFO - Epoch12: time_cost:3274.203512907028 train_loss:1.5528035289699782
2022-08-10 01:47:33,691 - root - INFO - train: loss:1.1631	rmse:1.1793	mae:0.7053	pmae:0.1584	pcc:0.9020
2022-08-10 01:47:33,692 - root - INFO - val: loss:2.7475	rmse:2.7432	mae:1.1698	pmae:0.2720	pcc:0.7589
2022-08-10 01:47:33,692 - root - INFO - test: loss:2.7366	rmse:2.6918	mae:1.1761	pmae:0.2795	pcc:0.7630
2022-08-10 01:47:37,343 - root - INFO - Epoch 13:
2022-08-10 05:16:23,330 - root - INFO - Epoch13: time_cost:5985.810671567917 train_loss:1.3900628646953153
2022-08-10 05:16:23,330 - root - INFO - train: loss:0.9707	rmse:0.9886	mae:0.6374	pmae:0.1431	pcc:0.9177
2022-08-10 05:16:23,331 - root - INFO - val: loss:2.6644	rmse:2.6614	mae:1.1520	pmae:0.2666	pcc:0.7664
2022-08-10 05:16:23,331 - root - INFO - test: loss:2.6957	rmse:2.6515	mae:1.1607	pmae:0.2745	pcc:0.7658
2022-08-10 05:16:27,185 - root - INFO - Epoch 14:
2022-08-10 06:49:16,660 - root - INFO - Epoch14: time_cost:3312.3757343292236 train_loss:1.2965056637762127
2022-08-10 06:49:16,660 - root - INFO - train: loss:0.9223	rmse:0.9419	mae:0.6491	pmae:0.1434	pcc:0.9234
2022-08-10 06:49:16,661 - root - INFO - val: loss:2.7464	rmse:2.7384	mae:1.1820	pmae:0.2765	pcc:0.7629
2022-08-10 06:49:16,661 - root - INFO - test: loss:2.7762	rmse:2.7299	mae:1.1947	pmae:0.2854	pcc:0.7635
2022-08-10 06:49:20,226 - root - INFO - Epoch 15:
2022-08-10 08:20:16,424 - root - INFO - Epoch15: time_cost:3288.8740363121033 train_loss:1.2354834893065827
2022-08-10 08:20:16,424 - root - INFO - train: loss:0.8397	rmse:0.8553	mae:0.5900	pmae:0.1300	pcc:0.9291
2022-08-10 08:20:16,424 - root - INFO - val: loss:2.7102	rmse:2.7056	mae:1.1626	pmae:0.2688	pcc:0.7621
2022-08-10 08:20:16,424 - root - INFO - test: loss:2.6911	rmse:2.6454	mae:1.1608	pmae:0.2734	pcc:0.7659
2022-08-10 08:20:19,655 - root - INFO - Epoch 16:
2022-08-10 15:04:14,843 - root - INFO - Epoch16: time_cost:8446.891885995865 train_loss:1.1207748133552857
2022-08-10 15:04:14,843 - root - INFO - train: loss:0.7311	rmse:0.7492	mae:0.5784	pmae:0.1266	pcc:0.9394
2022-08-10 15:04:14,843 - root - INFO - val: loss:2.7119	rmse:2.7098	mae:1.1685	pmae:0.2739	pcc:0.7662
2022-08-10 15:04:14,843 - root - INFO - test: loss:2.7121	rmse:2.6696	mae:1.1745	pmae:0.2806	pcc:0.7692
2022-08-10 15:04:20,823 - root - INFO - Epoch 17:
2022-08-10 22:34:49,328 - root - INFO - Epoch17: time_cost:13379.704071521759 train_loss:1.0461316006670023
2022-08-10 22:34:49,328 - root - INFO - train: loss:0.7343	rmse:0.7519	mae:0.5789	pmae:0.1284	pcc:0.9403
2022-08-10 22:34:49,328 - root - INFO - val: loss:2.8043	rmse:2.7985	mae:1.1874	pmae:0.2806	pcc:0.7591
2022-08-10 22:34:49,328 - root - INFO - test: loss:2.8246	rmse:2.7769	mae:1.1935	pmae:0.2882	pcc:0.7614
2022-08-10 22:34:54,205 - root - INFO - Epoch 18:
2022-08-11 02:02:25,490 - root - INFO - Epoch18: time_cost:7361.927431821823 train_loss:0.9731978252458074
2022-08-11 02:02:25,490 - root - INFO - train: loss:0.6088	rmse:0.6250	mae:0.5327	pmae:0.1150	pcc:0.9496
2022-08-11 02:02:25,491 - root - INFO - val: loss:2.7125	rmse:2.7132	mae:1.1656	pmae:0.2701	pcc:0.7639
2022-08-11 02:02:25,491 - root - INFO - test: loss:2.7167	rmse:2.6698	mae:1.1704	pmae:0.2770	pcc:0.7670
2022-08-11 02:02:29,539 - root - INFO - Epoch 19:
2022-08-11 05:40:30,072 - root - INFO - Epoch19: time_cost:5400.521614789963 train_loss:0.89877112810493
2022-08-11 05:40:30,073 - root - INFO - train: loss:0.6463	rmse:0.6600	mae:0.5770	pmae:0.1243	pcc:0.9513
2022-08-11 05:40:30,073 - root - INFO - val: loss:2.8290	rmse:2.8164	mae:1.1966	pmae:0.2832	pcc:0.7585
2022-08-11 05:40:30,073 - root - INFO - test: loss:2.8110	rmse:2.7668	mae:1.2020	pmae:0.2892	pcc:0.7643
2022-08-11 05:40:34,621 - root - INFO - Epoch 20:
2022-08-11 09:52:21,664 - root - INFO - Epoch20: time_cost:7132.209098577499 train_loss:0.831223150255078
2022-08-11 09:52:21,664 - root - INFO - train: loss:0.5734	rmse:0.5890	mae:0.5350	pmae:0.1153	pcc:0.9551
2022-08-11 09:52:21,664 - root - INFO - val: loss:2.8015	rmse:2.7889	mae:1.1896	pmae:0.2815	pcc:0.7605
2022-08-11 09:52:21,665 - root - INFO - test: loss:2.7799	rmse:2.7333	mae:1.1908	pmae:0.2874	pcc:0.7663
2022-08-11 09:52:25,266 - root - INFO - Epoch 21:
2022-08-11 12:29:40,297 - root - INFO - Epoch21: time_cost:4708.838912248611 train_loss:0.7887861552417418
2022-08-11 12:29:40,297 - root - INFO - train: loss:0.5970	rmse:0.6073	mae:0.5711	pmae:0.1207	pcc:0.9582
2022-08-11 12:29:40,297 - root - INFO - val: loss:2.9189	rmse:2.9029	mae:1.2197	pmae:0.2888	pcc:0.7574
2022-08-11 12:29:40,297 - root - INFO - test: loss:2.8836	rmse:2.8362	mae:1.2263	pmae:0.2968	pcc:0.7647
2022-08-11 12:29:43,774 - root - INFO - Epoch 22:
2022-08-11 15:51:02,547 - root - INFO - Epoch22: time_cost:7394.661440610886 train_loss:0.7364162945942221
2022-08-11 15:51:02,547 - root - INFO - train: loss:0.5774	rmse:0.5862	mae:0.5378	pmae:0.1122	pcc:0.9553
2022-08-11 15:51:02,547 - root - INFO - val: loss:2.9015	rmse:2.8852	mae:1.2011	pmae:0.2788	pcc:0.7515
2022-08-11 15:51:02,547 - root - INFO - test: loss:2.8248	rmse:2.7822	mae:1.2049	pmae:0.2851	pcc:0.7615
2022-08-11 15:51:02,547 - root - INFO - No improvement over 15 epochs, stop training
2022-08-11 15:51:02,547 - root - INFO - Loading the best model at epoch 6
2022-08-11 15:51:03,226 - root - INFO - Loaded the best model at epoch 6 for inference
2022-08-11 16:56:41,701 - root - INFO - Runs:0
 {'train': {'rmse': [3.0008, 2.8072, 2.649, 2.5447, 2.4292, 2.2911, 2.1161, 1.9756, 1.785, 1.6359, 1.4744, 1.2119, 1.1793, 0.9886, 0.9419, 0.8553, 0.7492, 0.7519, 0.625, 0.66, 0.589, 0.6073, 0.5862, 2.1161], 'mae': [1.246, 1.1992, 1.1581, 1.1243, 1.0937, 1.0507, 0.9902, 0.9437, 0.8901, 0.828, 0.7761, 0.7196, 0.7053, 0.6374, 0.6491, 0.59, 0.5784, 0.5789, 0.5327, 0.577, 0.535, 0.5711, 0.5378, 0.9902], 'pmae': [0.2973, 0.279, 0.2727, 0.2652, 0.2572, 0.245, 0.2312, 0.2187, 0.2091, 0.1864, 0.172, 0.1657, 0.1584, 0.1431, 0.1434, 0.13, 0.1266, 0.1284, 0.115, 0.1243, 0.1153, 0.1207, 0.1122, 0.2312], 'pcc': [0.7207, 0.7424, 0.7591, 0.7702, 0.7827, 0.7966, 0.8143, 0.8285, 0.8482, 0.8607, 0.8753, 0.8999, 0.902, 0.9177, 0.9234, 0.9291, 0.9394, 0.9403, 0.9496, 0.9513, 0.9551, 0.9582, 0.9553, 0.8143], 'loss': [3.059196592867974, 2.8545415256649598, 2.6847604860914034, 2.5713180517202114, 2.447619936974815, 2.300352551191195, 2.1182510444417098, 1.9763779468310996, 1.7815085639637547, 1.6322107976709883, 1.4718135429301593, 1.191179605128605, 1.1630843956387418, 0.9707363998048235, 0.9222860061800379, 0.839650664235311, 0.7310710798446685, 0.7342876441195014, 0.6087983335878598, 0.6463157106542947, 0.5734066726582682, 0.5969564156458415, 0.5774395738022062, 2.1182510444417098]}, 'val': {'rmse': [3.018, 2.8634, 2.7478, 2.7001, 2.6806, 2.6692, 2.6536, 2.6984, 2.6889, 2.7069, 2.7547, 2.6977, 2.7432, 2.6614, 2.7384, 2.7056, 2.7098, 2.7985, 2.7132, 2.8164, 2.7889, 2.9029, 2.8852, 2.6536], 'mae': [1.248, 1.2079, 1.1772, 1.1553, 1.1483, 1.1441, 1.1393, 1.1495, 1.1525, 1.1513, 1.1618, 1.1659, 1.1698, 1.152, 1.182, 1.1626, 1.1685, 1.1874, 1.1656, 1.1966, 1.1896, 1.2197, 1.2011, 1.1393], 'pmae': [0.2938, 0.2785, 0.2759, 0.2717, 0.2697, 0.2674, 0.2669, 0.2679, 0.2724, 0.2639, 0.2634, 0.2749, 0.272, 0.2666, 0.2765, 0.2688, 0.2739, 0.2806, 0.2701, 0.2832, 0.2815, 0.2888, 0.2788, 0.2669], 'pcc': [0.7233, 0.7404, 0.7523, 0.7573, 0.7597, 0.7611, 0.7623, 0.758, 0.7607, 0.7569, 0.7525, 0.7655, 0.7589, 0.7664, 0.7629, 0.7621, 0.7662, 0.7591, 0.7639, 0.7585, 0.7605, 0.7574, 0.7515, 0.7623], 'loss': [3.0302833111737226, 2.8732812592159833, 2.754618499268839, 2.707527719593848, 2.6858148547262863, 2.6764838729572613, 2.661717405037796, 2.704739696004431, 2.6969715736557185, 2.711780852387373, 2.763661834296072, 2.6984101327866767, 2.7475045098918125, 2.66437966970911, 2.7464096473234156, 2.7101774398063276, 2.7119193790689713, 2.8043122690752993, 2.712478767684484, 2.8290396257675794, 2.80148375318562, 2.9189313869309244, 2.9014710957681484, 2.661717405037796]}, 'test': {'rmse': [2.9431, 2.7954, 2.6863, 2.6309, 2.5841, 2.5645, 2.5929, 2.6269, 2.6257, 2.6019, 2.6807, 2.6529, 2.6918, 2.6515, 2.7299, 2.6454, 2.6696, 2.7769, 2.6698, 2.7668, 2.7333, 2.8362, 2.7822, 2.5929], 'mae': [1.2377, 1.2031, 1.1765, 1.1557, 1.1483, 1.1408, 1.1414, 1.1536, 1.1614, 1.1473, 1.1635, 1.1721, 1.1761, 1.1607, 1.1947, 1.1608, 1.1745, 1.1935, 1.1704, 1.202, 1.1908, 1.2263, 1.2049, 1.1414], 'pmae': [0.2977, 0.2833, 0.2813, 0.2771, 0.275, 0.2713, 0.2723, 0.273, 0.2795, 0.2669, 0.268, 0.2814, 0.2795, 0.2745, 0.2854, 0.2734, 0.2806, 0.2882, 0.277, 0.2892, 0.2874, 0.2968, 0.2851, 0.2723], 'pcc': [0.7284, 0.7444, 0.7566, 0.7625, 0.7682, 0.7702, 0.7667, 0.7637, 0.7663, 0.7652, 0.7575, 0.7692, 0.763, 0.7658, 0.7635, 0.7659, 0.7692, 0.7614, 0.767, 0.7643, 0.7663, 0.7647, 0.7615, 0.7667], 'loss': [2.9838595830279204, 2.8344766184342043, 2.723841239839391, 2.672994920372798, 2.6241812459552296, 2.60443385639899, 2.637245647262453, 2.672014907032538, 2.667452614649005, 2.6426120435298848, 2.720032770244665, 2.695717032100125, 2.736638714558209, 2.6956655135164853, 2.776178210703178, 2.691137623161399, 2.712081176086017, 2.8246358764080877, 2.7167177896917862, 2.8110281846083405, 2.7798618314199235, 2.8836279503028384, 2.8247535326415587, 2.637245647262453]}}
2022-08-11 16:56:45,791 - root - INFO - Final: test_rmse:2.5929 test_mae:1.1414 test_pmae:0.2723 test_pcc:0.7667
